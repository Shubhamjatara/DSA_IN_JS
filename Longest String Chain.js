/**
 * @param {string[]} words
 * @return {number}
 */
var longestStrChain = function (words) {
  const dp = new Array(words.length).fill(-1);
  words.sort((a, b) => a.length - b.length);
  let max = 1;
  for (let i = words.length - 1; 0 <= i; i--) {
    max = Math.max(max, f(i, words, dp));
  }
  return max;
};

function f(curr, word, dp) {
  if (dp[curr] != -1) return dp[curr];
  let max = 1;
  for (let pre = word.length - 1; 0 <= pre; pre--) {
    if (validate(word[curr], word[pre])) {
      max = Math.max(max, 1 + f(pre, word, dp));
    }
  }
  return (dp[curr] = max);
}

function validate(s1, s2) {
  if (s1.length + 1 !== s2.length) return false;

  let i = 0,
    j = 0,
    mismatch = 0;

  while (i < s1.length && j < s2.length) {
    if (s1[i] === s2[j]) {
      i++;
      j++;
    } else {
      j++;
      mismatch++;
      if (mismatch > 1) return false;
    }
  }

  return true;
}

//console.log(validate("cbc", "cbcd"));
console.log(longestStrChain(["a", "b", "ba", "bca", "bda", "bdca"]));
console.log(longestStrChain(["xbc", "pcxbcf", "xb", "cxbc", "pcxbc"]));
console.log(longestStrChain(["abcd", "dbqca"]));
console.log(longestStrChain(["x"]));
console.log(
  longestStrChain(["u", "v", "u", "z", "v", "v", "x", "x", "x", "x"])
);
console.log(longestStrChain(["uvvyzyuvuuxxyyz"]));
console.log(
  longestStrChain([
    "a",
    "ac",
    "acy",
    "aucy",
    "abucy",
    "abaucy",
    "abacucy",
    "abacfucy",
    "abacyfucy",
    "abacyfucey",
    "vabacyfucey",
    "vabacyfbucey",
    "vaubacyfbucey",
    "vaubacyfdbucey",
    "dvaubacyfdbucey",
    "dvaubaccyfdbucey",
    "a",
    "ae",
    "aey",
    "ayey",
    "ayeyd",
    "adyeyd",
    "avdyeyd",
    "yavdyeyd",
    "yadvdyeyd",
    "yadvydyeyd",
    "yadxvydyeyd",
    "yadxvydbyeyd",
    "yaydxvydbyeyd",
    "yaydxvydbyceyd",
    "yaydxvvydbyceyd",
    "yaydxfvvydbyceyd",
    "a",
    "va",
    "ava",
    "eava",
    "euava",
    "euxava",
    "euaxava",
    "euavxava",
    "euavvxava",
    "eufavvxava",
    "eufavvxazva",
    "eufavvxcazva",
    "eufavvvxcazva",
    "eufdavvvxcazva",
    "eubfdavvvxcazva",
    "eubfdavvvxxcazva",
    "a",
    "ae",
    "eae",
    "eaze",
    "beaze",
    "ubeaze",
    "ubeavze",
    "ubeauvze",
    "ubeauuvze",
    "xubeauuvze",
    "xubeabuuvze",
    "xubeabuuvzze",
    "xubeabuuvzzze",
    "bxubeabuuvzzze",
    "bxubeabuuvzzzey",
    "bxubeabubuvzzzey",
    "a",
    "ba",
    "cba",
    "cbca",
    "cbcay",
    "cybcay",
    "cybcday",
    "cxybcday",
    "cvxybcday",
    "cvzxybcday",
    "cvzxybecday",
    "cvzxybecdayz",
    "cvzxybecddayz",
    "cvzxybeecddayz",
    "cbvzxybeecddayz",
    "cbvzxyubeecddayz",
    "a",
    "ab",
    "azb",
    "adzb",
    "adzbf",
    "adzbff",
    "adzdbff",
    "dadzdbff",
    "dadfzdbff",
    "dazdfzdbff",
    "dazdfzdzbff",
    "dazdfzdzbffb",
    "dazddfzdzbffb",
    "edazddfzdzbffb",
    "edazddfczdzbffb",
    "edazddfczdzebffb",
    "a",
    "af",
    "ayf",
    "dayf",
    "dayfz",
    "dayfzz",
    "dauyfzz",
    "ddauyfzz",
    "ddauyfzzf",
    "ddauyefzzf",
    "ddauzyefzzf",
    "ddauzyezfzzf",
    "ddauzcyezfzzf",
    "ddaduzcyezfzzf",
    "ddaduzcyezefzzf",
    "ddaduzccyezefzzf",
    "a",
    "ea",
    "eda",
    "eyda",
    "euyda",
    "euydza",
    "eudydza",
    "ueudydza",
    "ueuddydza",
    "ueuddydzaf",
    "ueuyddydzaf",
    "uveuyddydzaf",
    "uveuydbdydzaf",
    "uveuydbdydzabf",
    "uveuydbddydzabf",
    "uveuydbddydzvabf",
    "a",
    "ba",
    "baa",
    "ybaa",
    "ydbaa",
    "ydabaa",
    "ydeabaa",
    "uydeabaa",
    "fuydeabaa",
    "fuydeabaaz",
    "fuydeaabaaz",
    "fuydeaabaeaz",
    "fuydeaabaeayz",
    "fuydeaabaeayaz",
    "fuydeaabaeaayaz",
    "fuydeaabaeafayaz",
    "a",
    "ca",
    "xca",
    "xcxa",
    "xcyxa",
    "xucyxa",
    "xucyxfa",
    "xucyxxfa",
    "xucyxxfaa",
    "xucyxxfaca",
    "xucyxxfuaca",
    "xucyxxfuayca",
    "xucxyxxfuayca",
    "xucxdyxxfuayca",
    "zxucxdyxxfuayca",
    "zxucxdyxxfuaayca",
    "a",
    "au",
    "uau",
    "vuau",
    "yvuau",
    "yvuacu",
    "yvuaucu",
    "yvvuaucu",
    "yvvuauzcu",
    "yvvuazuzcu",
    "yavvuazuzcu",
    "yavvuafzuzcu",
    "yavvuafzuzcuu",
    "yavvuafzfuzcuu",
    "yadvvuafzfuzcuu",
    "yadvvuafzfuxzcuu",
    "a",
    "aa",
    "aaz",
    "eaaz",
    "eaxaz",
    "eaxavz",
    "eadxavz",
    "xeadxavz",
    "xeaduxavz",
    "xdeaduxavz",
    "xdeaduxbavz",
    "xdeaduxbavuz",
    "xdeaduxbavuyz",
    "xdeaduxbcavuyz",
    "xdeaduxbcaxvuyz",
    "xdeaduxbcaaxvuyz",
    "a",
    "ac",
    "ace",
    "avce",
    "avcea",
    "afvcea",
    "afuvcea",
    "afuvcead",
    "afuvceadd",
    "afyuvceadd",
    "afyuvceaedd",
    "afyuvceaexdd",
    "afyuvceaexddx",
    "avfyuvceaexddx",
    "avfyufvceaexddx",
    "avfyufvceaexvddx",
    "a",
    "za",
    "zya",
    "zyau",
    "zyauu",
    "zyauuv",
    "zfyauuv",
    "xzfyauuv",
    "exzfyauuv",
    "exzfyabuuv",
    "eaxzfyabuuv",
    "exaxzfyabuuv",
    "fexaxzfyabuuv",
    "fexaxzfxyabuuv",
    "fexaxzfxyabuuvy",
    "fexaxvzfxyabuuvy",
    "a",
    "ad",
    "aud",
    "aued",
    "auecd",
    "auedcd",
    "ayuedcd",
    "ayuedccd",
    "ayuedccda",
    "ayuedccdae",
    "ayuedccddae",
    "ayuedccddaex",
    "aybuedccddaex",
    "aybuedccfddaex",
    "ayvbuedccfddaex",
    "ayuvbuedccfddaex",
    "a",
    "da",
    "eda",
    "edad",
    "edazd",
    "ebdazd",
    "ebdazfd",
    "evbdazfd",
    "evfbdazfd",
    "evbfbdazfd",
    "evbfbdazfdf",
    "evbfbdazfduf",
    "zevbfbdazfduf",
    "zevbfbdazzfduf",
    "zevxbfbdazzfduf",
    "zevxbfbdazzfdufz",
    "a",
    "aa",
    "aua",
    "auau",
    "auxau",
    "auxauc",
    "auxaubc",
    "auxfaubc",
    "auzxfaubc",
    "azuzxfaubc",
    "azuezxfaubc",
    "yazuezxfaubc",
    "yazueczxfaubc",
    "yaazueczxfaubc",
    "yadazueczxfaubc",
    "yadazueczxfaubbc",
    "a",
    "xa",
    "xax",
    "xdax",
    "xdbax",
    "xdbaux",
    "xdbbaux",
    "xdabbaux",
    "xxdabbaux",
    "xxxdabbaux",
    "xxxdeabbaux",
    "xxxdeabbauxx",
    "xxxdeaxbbauxx",
    "xxxdceaxbbauxx",
    "xaxxdceaxbbauxx",
    "xaxxfdceaxbbauxx",
    "a",
    "ua",
    "uax",
    "uuax",
    "uuavx",
    "uuavxx",
    "uubavxx",
    "uubaxvxx",
    "uubaxdvxx",
    "uubaxdvyxx",
    "uucbaxdvyxx",
    "vuucbaxdvyxx",
    "vuucbuaxdvyxx",
    "vuucabuaxdvyxx",
    "vuucdabuaxdvyxx",
    "vuucdabuaxdvyxxb",
    "a",
    "ab",
    "fab",
    "fabu",
    "fabzu",
    "vfabzu",
    "vfabzau",
    "vfabzaub",
    "vfabvzaub",
    "yvfabvzaub",
    "yvfabvzauyb",
    "yvbfabvzauyb",
    "yvbfabvezauyb",
    "yvbfabveezauyb",
    "yvbfabveezauyyb",
    "yvbfabveezauyyab",
    "a",
    "ae",
    "aee",
    "aeue",
    "aeuce",
    "aeucee",
    "aeudcee",
    "aeudcaee",
    "aeudcaeee",
    "aeudcaeeee",
    "aeudcafeeee",
    "aeudcafeeeec",
    "xaeudcafeeeec",
    "xaeudcafeeeeyc",
    "xaeudcafeeeveyc",
    "xaeudcafeeeaveyc",
    "a",
    "ba",
    "fba",
    "fbda",
    "fbdva",
    "fbedva",
    "fbedbva",
    "fbcedbva",
    "fbcedbvaa",
    "fbcaedbvaa",
    "fbcaedbvaaa",
    "afbcaedbvaaa",
    "zafbcaedbvaaa",
    "zafbcavedbvaaa",
    "zafbacavedbvaaa",
    "zazfbacavedbvaaa",
    "a",
    "va",
    "yva",
    "yvya",
    "yvyda",
    "yvybda",
    "yvybdab",
    "yvybdaby",
    "yvcybdaby",
    "dyvcybdaby",
    "dyvfcybdaby",
    "dyvyfcybdaby",
    "dyvyfacybdaby",
    "adyvyfacybdaby",
    "adfyvyfacybdaby",
    "adfyvyfacybdabfy",
    "a",
    "az",
    "vaz",
    "vfaz",
    "fvfaz",
    "fvfavz",
    "fvfavza",
    "fxvfavza",
    "fxavfavza",
    "fxavvfavza",
    "fxavfvfavza",
    "xfxavfvfavza",
    "xfxcavfvfavza",
    "xfxcavfvfauvza",
    "vxfxcavfvfauvza",
    "vxfxcavfvfxauvza",
    "a",
    "za",
    "zba",
    "zaba",
    "zabda",
    "zaebda",
    "zaebday",
    "zaeabday",
    "zaeabdauy",
    "zaeabdaauy",
    "zaeabdaauyc",
    "zaeabdaauyyc",
    "zaeabdavauyyc",
    "zaezabdavauyyc",
    "zaezabdavauyycy",
    "yzaezabdavauyycy",
    "a",
    "fa",
    "fca",
    "fcav",
    "fcdav",
    "fcdaav",
    "fcdaaxv",
    "fcdaaxyv",
    "ufcdaaxyv",
    "ufcdaaxyvv",
    "ufcdaxaxyvv",
    "ufcdaxaxyvuv",
    "ufcdaxaxdyvuv",
    "ufcdaxaxdyyvuv",
    "ufcdaxaxdyyvduv",
    "ufcvdaxaxdyyvduv",
    "a",
    "ca",
    "caa",
    "caca",
    "fcaca",
    "yfcaca",
    "yfacaca",
    "yfacyaca",
    "ycfacyaca",
    "ycfacyazca",
    "ycbfacyazca",
    "ycbfacyazcca",
    "ycbfacyazecca",
    "ycbfacyazeccav",
    "ycbcfacyazeccav",
    "ycbcfacyauzeccav",
  ])
);
console.log(
  longestStrChain([
    "a",
    "ac",
    "abc",
    "aca",
    "acb",
    "acc",
    "acd",
    "ace",
    "acf",
    "acg",
    "ach",
    "aci",
    "acj",
    "ack",
    "acl",
    "acm",
    "acn",
    "aco",
    "acp",
    "acq",
    "acr",
    "acs",
    "act",
    "acu",
    "acv",
    "acw",
    "acx",
    "acy",
    "abcz",
  ])
);
